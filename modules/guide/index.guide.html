<?=Tbmt\view\Factory::buildPageTitle($this->i18nView['page_title'])?>

<div class="container">

  <div class="heading-area text-center bottom-30 top-30">
    <h4 class="heading large">Buy the Happiness Guide</h4>
  </div>

  <div class="row bottom-30 top-30 sheet">

      <p>add beautiful previews</p>

      <div id="paypal-button"></div>
  </div>
</div>

<script src="https://www.paypalobjects.com/api/checkout.js" data-version-4></script>
<script>
    paypal.Button.render({

// Paypal Sandbox app
// Sandbox Accountfinance-facilitator@betterliving.social
// Access Tokenaccess_token$sandbox$v5gvxz5kr5k5jfnc$d305ed5f6b76631c9f1533d4e158b18d
// Expiry Date15 Nov 2026

        env: 'sandbox', // Specify 'sandbox' for the test environment
        client: {
            sandbox: 'AViDHwZfNbaqBZCRRFaPcOdA6ARynGxeaX_cyIX-eCUPWE_W6aF-AQgvr0L1kGsotnNvZeAtp4WWV5qD',
        },

        payment: function(resolve, reject) {
            // Set up the payment here, when the buyer clicks on the button
            var env    = this.props.env;
            var client = this.props.client;

            var CREATE_PAYMENT_URL = '<?php echo $this->createPPPUrl; ?>';

            paypal.request.post(CREATE_PAYMENT_URL)
                .then(function(data) {
                  resolve(data.paymentID);
                })
                .catch(function(err) {
                  reject(err);
                });
        },

        onAuthorize: function(data, actions) {
            var EXECUTE_PAYMENT_URL = '<?php echo $this->executePPPUrl; ?>';

            paypal.request.post(EXECUTE_PAYMENT_URL,
                  { paymentID: data.paymentID, payerID: data.payerID }
                )
                .then(function(data) { /* Go to a success page */ })
                .catch(function(err) { /* Go to an error page  */ });
       },

        onCancel: function(data, actions) {
            // Execute the payment here, when the buyer approves the transaction
            console.log('onCancel');
       }

    }, '#paypal-button');
</script>