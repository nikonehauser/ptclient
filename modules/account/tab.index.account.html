  <?php
    use \Tbmt\Base;

    if ( $this->signupmsg ) {
      echo \Tbmt\view\Factory::buildNotification(
        \Tbmt\Localizer::insert($this->i18nView['welc_not_1'], ['name' => \Tbmt\view\Factory::buildMemberFullNameString($this->member)]),
        '',
        'success top',
        '<p>'.$this->i18nView['welc_not_2'].'</p>'
      );
    }

    if ( $this->payoutFailed ) {
      ?>

      <div class="row top-40">
        <div class="col-md-12">
          <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['attention'], 'bottom-30')?>

          <?=\Tbmt\view\Factory::buildNotification($this->i18nView['payoutfailed'], $this->i18nView['attention'], 'notice top')?>

          <h3><?=$this->i18nView['payoutfailed_reason']?></h3>

          <pre class="wordwrap"><?=$this->payoutFailed->getFailedReaonsText()?></pre>

          <p><?=$this->i18nView['payoutfailed_text1']?></p>
          <p><?=$this->i18nView['payoutfailed_text2']?></p>

          <pre class="wordwrap"><?=$this->payoutFailed->getBankAccountText()?></pre>

          <p><?=$this->i18nView['payoutfailed_text3']?></p>

          <?php if ( $this->payoutFailed->getTransfer()->getState() === \Transfer::STATE_IN_EXECUTION ) : ?>
            <?=\Tbmt\view\Factory::buildNotification($this->i18nView['transfer_state_restored'], $this->i18nView['tank_you'], 'success top')?>

          <?php else : ?>
            <?=\Tbmt\view\Factory::buildNotification($this->i18nView['transfer_state_pending'], $this->i18nView['warning'], 'warning top')?>

          <?php endif; ?>

        </div>
      </div>


      <?php
    }


    if ( !$this->member->hadPaid() ) {
      echo \Tbmt\view\Factory::buildNotification($this->i18nView['unpaid_text'], $this->i18nView['warning'], 'warning top');

      ?>

      <div class="row top-40">
        <div class="col-md-12">
          <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['gettingstarted'], 'bottom-30')?>
          <h3>You have done your firts step towards a better future.</h3>
          <p>What you have to do next is to purchase our Happiness Guide. This will grant you access to our marketing system.</p>
          <p>If you want more information, no problem! Just follow these links:</p>
          <ul>
            <li><a class="highlighted" href="<?php echo \Tbmt\Router::toModule('about', 'faq'); ?>">you can browse our FAQ's</a></li>
            <li><a class="highlighted" href="<?php echo \Tbmt\Router::toModule('about', 'contact'); ?>">you can ask any question with our contact form</a></li>
          </ul>

        </div>
      </div>

      <div class="row bottom-20">
        <div class="col-md-12">

          <h3 class="top-20">Want to go on? Nice! Then follow the red button:</h3>

          <?=\Tbmt\view\Factory::buildButton(
            $this->i18nView['purchase_now'],
            \Tbmt\Router::toModule('guide'),
            ' ',
            'shopping-cart'
          )?>

          <p>After your purchase you will get all you need back here!</p>
        </div>
      </div>

      <?php

    } else {
      ?>

      <div class="row top-20">
        <div class="col-md-12">
          <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['purchasedtitle'], 'bottom-30')?>

          <?=\Tbmt\view\Factory::buildNotification($this->i18nView['paid_text'], $this->i18nView['tank_you'], 'info top')?>

          <h3>Very good decision!</h3>
          <p>This is your exclusive invitation link:</p>
          <pre class="wordwrap"><?php echo \Tbmt\Config::get('extended.system.url')."?tkn=".$this->member->getHash().'#video_explanation'; ?></pre>
          <p>Use this link to invite your friends and earn the systems rewards.</p>

        </div>
      </div>

      <?php
    }
  ?>

    <div class="row top-40">
      <div class="col-md-12">
        <?=\Tbmt\view\Factory::buildHeadingArea('IMPORTANT', 'bottom-30')?>
        <p>This number <span class="highlight blue"><?php echo $this->member->getNum(); ?></span> is your member number!</p>
        <p>Remember it! You need this number to login!</p>

      </div>
    </div>

    <div class="row top-40">
      <div class="col-md-6">
          <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['account'], 'bottom-30 top-10')?>

          <dl class="dl-horizontal dl-largeSpaced dl-prettyStyled">
              <?php
              if ( $this->member->getType() > \Member::TYPE_MEMBER ) {
                echo '<dt>'.$this->i18nView['member_type'].'</dt>
                  <dd>'.$this->i18nCommon['member_types'][$this->member->getType()].'</dd>';

              }
              ?>

              <dt><?=$this->i18nView['your_num']?></dt>
              <dd><?=$this->member->getNum()?></dd>

              <?php
              if ( $this->member->getBonusLevel() > 0 ) {
                echo '<dt>'.$this->i18nView['bonus_level'].'</dt>
                  <dd>+ '.\Tbmt\Localizer::currencyFormat($this->member->getBonusLevel(),
                        [\Transaction::$BASE_CURRENCY]
                      ).'</dd>';

              }
              ?>

              <dt><?=$this->i18nView['address']?></dt>
              <dd>
                  <?=\Tbmt\view\Factory::buildMemberAddress($this->member)?>
              </dd>

              <dt><?=$this->i18nView['email']?></dt>
              <dd>
                  <?=$this->member->getEmail() ?
                  Base::encodeHtml($this->member->getEmail()) :
                  '<em class="text-muted">'.$this->i18nView['email_none'].'</em>'?>
              </dd>
          </dl>
      </div>
      <div class="col-md-6">
          <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['bank_account'], 'bottom-30 top-10')?>

          <dl class="dl-horizontal dl-largeSpaced dl-prettyStyled">
              <dt><?=$this->i18nView['bank_recipient']?></dt>
              <dd><?=Base::encodeHtml($this->member->getBankRecipient())?></dd>

              <dt><?=$this->i18nView['iban']?></dt>
              <dd><?=Base::encodeHtml($this->member->getIban())?></dd>

              <dt><?=$this->i18nView['bic']?></dt>
              <dd><?=Base::encodeHtml($this->member->getBic())?></dd>
          </dl>

          <?=\Tbmt\view\Factory::buildButton(
            $this->i18nView['change_profile'],
            \Tbmt\Router::toModule('manage', 'change_profile'),
            ' blue pull-right',
            'credit-card'
          )?>

          <?=\Tbmt\view\Factory::buildButton(
            $this->i18nView['change_pwd'],
            \Tbmt\Router::toModule('manage', 'change_pwd'),
            ' yellow',
            'lock'
          )?>
      </div>
    </div>

    <div class="row top-40" >
      <div class="col-md-12">
        <?=\Tbmt\view\Factory::buildHeadingArea($this->i18nView['guides'], 'bottom-30 top-10')?>
      </div>
    </div>

    <div class="row" >
      <?php if ( !$this->guidesCount ) : ?>

        <div class="col-md-12">
          <?php echo \Tbmt\view\Factory::buildNotification($this->i18nView['guides_not_available'], '', 'info'); ?>
        </div>

      <?php else: ?>

        <div class="col-md-12">

          <div style="padding-left: 25px;" class="widget category">

            <ul><?php

              for ( $i = 1; $i <= $this->guidesCount; $i++ ) {
                echo '<li><a target="_blank" href="'.\Tbmt\Router::toModule('download', 'guide', ['number' => $i]).'">'.
                  \Tbmt\Localizer::insert($this->i18nView['guide_name'], ['number' => $i]).
                  '</a></li>';
              }

            ?></ul>
          </div>
        </div>

      <?php endif; ?>
    </div>